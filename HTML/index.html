<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos de Cookies</title>
    <script src="../JS/script.js"></script>
    <link rel="stylesheet" href="..\CSS\base\header.css">
    <link rel="stylesheet" href="..\CSS\base\style.css">
    <link rel="stylesheet" href="..\CSS\base\footer.css">
    <style>
        body {
            text-align: center;
        }

        #cookies {
            text-align: center;
        }

    </style>
    <script>
        function calcularTotal() {
            let totalGeral = 0;
            const precoPorCaixa = 10.00;

            for (let i = 1; i <= 6; i++) {
                let quantidade = document.getElementById("quantidade_sabor" + i).value;
                let totalPorSabor = quantidade * precoPorCaixa;
                document.getElementById("total_sabor" + i).innerText = "R$ " + totalPorSabor.toFixed(2);
                totalGeral += totalPorSabor;
            }

            document.getElementById("total_geral").innerText = "Total: R$ " + totalGeral.toFixed(2);
        }

        function verificarCPF() {
            const cpf = document.getElementById("cpf").value;
            const cpfValido = validarCPF(cpf);

            if (!cpfValido) {
                alert("CPF inválido. Por favor, insira um CPF válido.");
                return false; // Impede o envio do formulário
            }

            return true; // CPF válido, permite envio do formulário
        }

        function validarCPF(cpf) {
            cpf = cpf.replace(/[^\d]+/g, ''); // Remove caracteres não numéricos
            if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) {
                return false;
            }

            let soma = 0;
            let resto;

            for (let i = 1; i <= 9; i++) {
                soma += parseInt(cpf.substring(i - 1, i)) * (11 - i);
            }

            resto = (soma * 10) % 11;

            if (resto === 10 || resto === 11) {
                resto = 0;
            }

            if (resto !== parseInt(cpf.substring(9, 10))) {
                return false;
            }

            soma = 0;

            for (let i = 1; i <= 10; i++) {
                soma += parseInt(cpf.substring(i - 1, i)) * (12 - i);
            }

            resto = (soma * 10) % 11;

            if (resto === 10 || resto === 11) {
                resto = 0;
            }

            return resto === parseInt(cpf.substring(10, 11));
        }
    </script>
</head>
<body>
    <main>
        <h1>Faça seu Pedido</h1>
        <form action="processar_pedido.php" method="POST" onsubmit="return verificarCPF()">
            <h2>Sabores Disponíveis</h2>
            <p class="aviso">*Cada caixa contém 8 unidades de cookies deliciosos por R$ 10.00</p>
            <div id="cookies">
                <label for="quantidade_sabor1">Fúria Vermelha:</label>
                <input type="number" id="quantidade_sabor1" name="quantidade_sabor1" value="0" min="0" oninput="calcularTotal()">
                <span id="total_sabor1">R$ 0.00</span><br>

                <label for="quantidade_sabor2">Brocado de Cacau:</label>
                <input type="number" id="quantidade_sabor2" name="quantidade_sabor2" value="0" min="0" oninput="calcularTotal()">
                <span id="total_sabor2">R$ 0.00</span><br>

                <label for="quantidade_sabor3">Fibroso:</label>
                <input type="number" id="quantidade_sabor3" name="quantidade_sabor3" value="0" min="0" oninput="calcularTotal()">
                <span id="total_sabor3">R$ 0.00</span><br>

                <label for="quantidade_sabor4">Mata Fome:</label>
                <input type="number" id="quantidade_sabor4" name="quantidade_sabor4" value="0" min="0" oninput="calcularTotal()">
                <span id="total_sabor4">R$ 0.00</span><br>

                <label for="quantidade_sabor5">Brocado de Recheio:</label>
                <input type="number" id="quantidade_sabor5" name="quantidade_sabor5" value="0" min="0" oninput="calcularTotal()">
                <span id="total_sabor5">R$ 0.00</span><br>

                <label for="quantidade_sabor6">Mata Fome 2.0:</label>
                <input type="number" id="quantidade_sabor6" name="quantidade_sabor6" value="0" min="0" oninput="calcularTotal()">
                <span id="total_sabor6">R$ 0.00</span><br>
                
                <h3 id="total_geral">Total: R$ 0.00</h3>
            </div>

            <hr>

            <h2>Preencha com seus dados para contato e envio!</h2>
            <label for="nome">Nome:</label>
            <input type="text" id="nome" name="nome" required><br>

            <label for="cpf">CPF:</label>
            <input type="text" id="cpf" name="cpf" minlength="11" maxlength="15" required><br><br>

            <label for="endereco">Endereço:</label>
            <input type="text" id="endereco" name="endereco" required><br>
            <label for="numero">Número:</label>
            <input type="text" id="numero" name="numero" minlength="1" maxlength="5" required><br>
            <label for="complemento">Complemento:</label>
            <input type="text" id="complemento" name="complemento"><br><br>

            <label for="email">E-mail:</label>
            <input type="email" id="email" name="email" required><br>

            <label for="telefone">Telefone:</label>
            <input type="text" id="telefone" name="telefone" minlength="9" maxlength="14" required><br><br>

            <hr>


            <label for="mensagem">Mensagem:</label><br>
            <textarea id="mensagem" name="mensagem" rows="6" cols="50" placeholder="Aqui você pode comentar, mandar mensagem, qualquer coisa! Abra seu coração."></textarea><br>

            <input class="button" type="submit" value="Enviar Pedido">
        </form>
    </main>
    
    <footer>
        <p>Copyright &copy; <a href="#">Cookies S/A</a><br>Created by <a href="https://linktr.ee/birabalaz">Erick Monteiro</a></p>
    </footer>
</body>
</html>
